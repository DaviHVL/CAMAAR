<div class="p-8">
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    
    <% if @turmas.any? %>
      <% @turmas.each do |turma| %>
        
        <%# CORREÇÃO: Iterar sobre TODOS os formulários da turma, não apenas o first %>
        <% turma.formularios.each do |formulario| %>
        
          <%# 1. Se o aluno JÁ respondeu este formulário específico, pula ele. %>
          <% next if @ids_respondidos.include?(formulario.id) %>
          
          <%# 2. Renderiza o Card para ESTE formulário %>
          <%= render(EvaluationCardComponent.new(
                turma: turma.num_turma,
                materia: turma.materia.nome,
                professor: turma.professor, # Certifique-se que o método professor existe em Turma
                semestre: turma.semestre,
                formulario_id: formulario.id,
                turma_id: turma.id
              )) %>
              
        <% end %> <%# Fim do loop de formulários %>

      <% end %> <%# Fim do loop de turmas %>
    <% else %>
      <p class="text-gray-500">Nenhuma turma encontrada.</p>
    <% end %>

  </div>
</div>